{"version":3,"sources":["pages/profile_page.js"],"names":["$","requiredError","window","_radonOptions","invalidEmailError","invalidPhoneError","valid","validateForm","$form","find","remove","field","not","value","this","val","attr","is","intlTelInput","addClass","parents","_utils","validateEmail","append","renderErrors","errors","url","method","data","beforeSend","$confirmBtn","prop","responseJSON","setTimeout","name","submitForm","ajax","action","serialize","error","formValid","success","preventDefault","disabled","message","each","jQuery","indx","item","onsubmit","e","blur","submit"],"mappings":"cAAA,SAACA,GACC,IAAAC,EAAAC,OAAAC,cAAAF,cAGIG,EAAoBF,OAAOC,cAAcC,kBADzCH,EAAgBC,OAAOC,cAAcF,kBAErCI,EAAAA,SAAAA,GAGF,IAAIC,GAAQ,EADRC,OAAAA,EACAD,OAAAA,EAiEFE,OA/DFA,EAGGC,KAAK,cADRD,YACQ,aAELC,KAAK,cAGRD,SAEAA,EACGC,KAAK,aACDC,SAGHF,EACEG,KAAAA,SAJHC,IAAI,mBASDN,KAAAA,aACDO,EAAAb,EAAAc,MAAAC,QAPaf,EAAEc,MAAME,KAAK,cASvBhB,EAAQiB,EAARH,MACGd,QAAQkB,eACTC,SACCC,aAGHd,OAAQN,EAAAC,IAEXK,GAAA,GAGKN,EAACqB,MAAOC,GAAR,mCAA8BT,IAC9Bb,EAAFc,MACGM,aAAQ,mBAGXd,EAAAA,MACDc,QAAA,eACFD,SAAA,aAhCLI,OAAAvB,EAAAK,IAkCAC,GAAA,IAIEkB,EAAAA,MAAAA,GAAAA,mBAAgBC,IAClBJ,OAAAC,cAAAT,KAEGJ,EADHK,MAbWM,QAAQ,eAmBRD,SAAA,aAjBAI,OAAOvB,EAAEI,IAmBfE,GAAL,MAKEE,GAfAgB,EAAe,SAACC,EAAQjB,GAwB1BR,EACE0B,KAAKlB,cACLmB,YAAQnB,aACRoB,KAAMpB,cACNqB,SAECrB,EANIC,KAAA,aAAAC,SAQHoB,IAAAA,IAAAA,KAAYC,EAAK,CACjBP,IAAAA,EAAAA,eAAkBQ,GATf,OAgBHX,EACAY,KADAZ,UACWa,EADXb,MAEES,QAAAA,eADFX,SAAA,aAGDI,OAJCF,6BAIDI,EAAAS,GAJCb,iBAQJc,EAAA,SAAF3B,EACQsB,GAGJ9B,EAAAoC,MACEpC,IAAEQ,EAAF,GAAA6B,OACDV,OAAAnB,EAAA,GAAAmB,OANLC,KAAApB,EAAA8B,YApBIT,WAAY,WA6BdC,EAAAC,KAAF,YAA6B,IAE3BQ,MAAIT,SAActB,GACdgC,EAAYT,KAAhB,YAAA,GA3BIP,EAAaI,EAAKI,aAAcxB,IA8BlCiC,QAAID,SAAWZ,GACbpB,EADFC,KAEO,SACHiC,IAAAA,mBACF3B,IAAI4B,IACJtB,OAAKsB,eAAU,UAAAf,EAAAgB,SACbd,WAAAA,WACAA,EAAIvB,KAAaC,YAAQ,IACvB,SAKCR,EAAA,kBA3BRS,KAAK,SA6BEqB,IAAAA,mBACDe,KAAA,WACF7C,EAAAc,MAAAE,KAAA,QACDhB,EAAAc,MAAOC,IAAP,MA3IRf,EA+IG8C,sBA/IHD,KAAA,SAAAE,EAAAC,GAoHI,IAAIxC,EAAQR,EAAEgD,GACVlB,EAActB,EAAMC,KAAK,yBACzB+B,GAAY,EAEhBhC,EAAM,GAAGyC,SAAW,SAASC,GAC3B,QAAIV,IAGFU,EAAER,iBACaZ,EAAYC,KAAK,cAE9BD,EAAYqB,OACR5C,EAAaC,KACXA,EAAMS,GAAG,kBACXuB,GAAY,EACZhC,EAAM4C,UAENjB,EAAW3B,EAAOsB,GAGpBA,EAAYC,KAAK,YAAY,MAG1B,MA3If,CA+IGe","file":"profile_page.js","sourcesContent":["($ => {\n  \"use strict\";\n\n  let requiredError = window._radonOptions.requiredError;\n  let invalidEmailError = window._radonOptions.invalidEmailError;\n  let invalidPhoneError = window._radonOptions.invalidPhoneError;\n\n  const validateForm = $form => {\n    let valid = true;\n    let value;\n    let field;\n\n    $form\n      .find(\".has-error\")\n      .removeClass(\"has-error\")\n      .find(\".errorlist\")\n      .remove();\n\n    $form.find(\".nonfield\").remove();\n\n    $form\n      .find(\"input\")\n      .not('[type=\"hidden\"]')\n      .each(function() {\n        value = $(this).val();\n        if (!value && $(this).attr(\"required\")) {\n          field = $(this)\n            .parents(\".form-group\")\n            .addClass(\"has-error\")\n            .append($(requiredError));\n\n          valid = false;\n        }\n\n        if ($(this).is(`[name=\"phone_number_modified\"]`) && value) {\n          if (!$(this).intlTelInput(\"isValidNumber\")) {\n            $(this)\n              .parents(\".form-group\")\n              .addClass(\"has-error\")\n              .append($(invalidPhoneError));\n            valid = false;\n          }\n        }\n\n        if ($(this).is(`[type=\"email\"]`) && value) {\n          if (!_utils.validateEmail(value)) {\n            $(this)\n              .parents(\".form-group\")\n              .addClass(\"has-error\")\n              .append($(invalidEmailError));\n            valid = false;\n          }\n        }\n      });\n    void 0;\n    return valid;\n  };\n\n  let renderErrors = (errors, $form) => {\n    void 0;\n    $form\n      .find(\".has-error\")\n      .removeClass(\"has-error\")\n      .find(\".errorlist\")\n      .remove();\n\n    $form.find(\".nonfield\").remove();\n\n    for (let name in errors) {\n      if (!errors.hasOwnProperty(name)) {\n        return;\n      }\n\n      $form\n        .find(`[name=\"${name}\"]`)\n        .parents(\".form-group\")\n        .addClass(\"has-error\")\n        .append(`<ul class=\"errorlist\"><li>${errors[name]}</li></ul> `);\n    }\n  };\n\n  let submitForm = ($form, $confirmBtn) => {\n    $.ajax({\n      url: $form[0].action,\n      method: $form[0].method,\n      data: $form.serialize(),\n      beforeSend: function() {\n        $confirmBtn.prop(\"disabled\", true);\n      },\n      error: function(data) {\n        $confirmBtn.prop(\"disabled\", false);\n        renderErrors(data.responseJSON, $form);\n      },\n      success: function(data) {\n        $form\n          .find(\"input\")\n          .not('[type=\"hidden\"]')\n          .val(\"\");\n        _utils.renderMessages(\"success\", data.message);\n        setTimeout(function() {\n          $confirmBtn.prop(\"disabled\", false);\n        }, 5000);\n      }\n    });\n  };\n\n  $(\"#password_form\")\n    .find(\"input\")\n    .not('[type=\"hidden\"]')\n    .each(function() {\n      if (!$(this).attr(\"val\")) {\n        $(this).val(\"\");\n      }\n    });\n\n  $(\".profile-page form\").each(function(indx, item) {\n    let $form = $(item);\n    let $confirmBtn = $form.find('button[type=\"submit\"]');\n    let formValid = false;\n\n    $form[0].onsubmit = function(e) {\n      if (formValid) {\n        return true;\n      } else {\n        e.preventDefault();\n        var disabled = $confirmBtn.prop(\"disabled\");\n        if (!disabled) {\n          $confirmBtn.blur();\n          if (validateForm($form)) {\n            if ($form.is(\"#profile_form\")) {\n              formValid = true;\n              $form.submit();\n            } else {\n              submitForm($form, $confirmBtn);\n            }\n\n            $confirmBtn.prop(\"disabled\", true);\n          }\n        }\n        return false;\n      }\n    };\n  });\n})(jQuery);\n"]}